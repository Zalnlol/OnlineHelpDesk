
@using Microsoft.AspNetCore.Http;
@{
    TempData["Title"] = "Login";
}
<script src="~/js/Validate.js"></script>
<!--CND VueJs-->
<script src="https://cdn.jsdelivr.net/npm/vue@2/dist/vue.js"></script>
<div id="myApp">



    <div class="form-group">
        <label>Mail</label>
        <input type="text" v-model="Mail" />
    </div>


    <div class="form-group">
        <label>Password</label>
        <input type="password" v-model="Password" />
    </div>

    <div class="form-group">
        <label class="text-danger" ref="error"></label>
    </div>
    <div class="form-group">
        <button v-on:click.prevent="Login()" class="btn btn-success">Submit</button>
    </div>


    

</div>
<script>
    var App = new Vue({
        el: "#myApp",
        data() {
            return {
                Mail: '',
                Password: ''
            }

        },
        methods: {
            Login: function () {
                
                if ((this.Mail == "") && (this.Password == "")) {
                    this.$refs.error.innerText = "Email and Password cannot be left blank"

                    return false;
                }

                if (this.Mail == "") {
                    this.$refs.error.innerText = "Email cannot be left blank"

                    return false;
                }

                if (this.Password == "") {
                    this.$refs.error.innerText = "Password cannot be left blank"

                    return false;


                }
                

      
                if (check.test(this.Mail) == false) {
                    this.$refs.error.innerText = "Email is not in the correct format"
                } else {

                    let result = false;

                    let url = "/Home/Login?mail=" + this.Mail + "&password=" + this.Password;
                    var request = new XMLHttpRequest();
                    request.open('POST', url, false);  // `false` makes the request synchronous
                    request.send(null);

                    if (request.status === 200) {// That's HTTP for 'ok'
                        console.log(request.responseText);
                        if (request.responseText == "admin") {
                            location.href = "/admin/admin"
                        }
                        else
                        if (request.responseText == "true") {



                            location.href = "/home/Roomlist"
                        } else {
                            this.$refs.error.innerText = request.responseText
                          
                        }


                    }


                }



            }

        }
        })

</script>